/**
 * @file
 * @ingroup gen_cfw
 *
 * Implementation of TC(12,15) MonEnbParMonFuncCmd as an incoming command.
 *
 * @note This file was generated on 2018-09-29 23:48:04
 * @author Automatically Generated by CORDET Editor
 * @copyright P&P Software GmbH
 */

#include "CrPsInCmdMonEnbParMonFuncCmd.h"
#include "DataPool/CrPsDpMon.h"
#include "InCmd/CrFwInCmd.h"
#include "FwPrCore.h"

/* ------------------------------------------------------------------------ */
void CrPsInCmdMonEnbParMonFuncCmdStartAction(FwSmDesc_t smDesc) {
    if (getDpMonParMonFuncEnbStatus() == ENABLED) {
        setDpVerFailData(0);
        CrFwSetSmOutcome(smDesc, VER_MON_ENB);
        return;
    }

    /* Set action outcome to 'success' */
    CrFwSetSmOutcome(smDesc, 1);
}

/* ------------------------------------------------------------------------ */
void CrPsInCmdMonEnbParMonFuncCmdProgressAction(FwSmDesc_t smDesc) {
    CrFwDestSrc_t src;

    /* Start the Parameter Monitoring Function */
    FwPrStart(CrPsConfigGetParMonPr());

    /* Load the source of the user of the monitoring service */
    src = CrFwInCmdGetSrc(smDesc);
    setDpMonServUser(src);

    /* Set Parameter Monitoring Function status to 'enabled' */
    setDpMonParMonFuncEnbStatus(ENABLED);

    /* Set outcome to 'success' and completion outcome to 'completed' */
    CrFwSetSmOutcome(smDesc, 1);
    CrFwInCmdSetProgressActionCompleted(smDesc, 1);
}

